 Liouville's theorem}}  In physics, "Liouville's theorem", named after the French mathematician Joseph Liouville, is a key theorem in classical statistical mechanics|statistical and Hamiltonian mechanics. It asserts that "the phase space|phase-space distribution function is constant along the Trajectory|trajectories of the system"—that is that the density of system points in the vicinity of a given system point traveling through phase-space is constant with time. This time-independent density is in statistical mechanics known as the classical a priori probability.Harald J. W. Müller-Kirsten, Basics of Statistical Physics, 2nd ed., World Scientific (Singapore, 2013) There are related mathematical results in symplectic topology and ergodic theory; systems obeying Liouville's theorem are examples of conservative system|incompressible dynamical systems. There are extensions of Liouville's theorem to stochastic systems. ==Liouville equation== File:Hamiltonian flow classical.gif|frame|Evolution of an ensemble of Hamiltonian mechanics|classical systems in phase space (top). Each system consists of one massive particle in a one-dimensional potential well (red curve, lower figure). Whereas the motion of an individual member of the ensemble is given by Hamilton's equations, Liouville's equation describes the flow of the whole distribution. The motion is analogous to a dye in an incompressible fluid. The Liouville equation describes the time evolution of the "phase space Distribution function (physics)|distribution function". Although the equation is usually referred to as the "Liouville equation", Josiah Willard Gibbs was the first to recognize the importance of this equation as the fundamental equation of statistical mechanics.J. W. Gibbs, "On the Fundamental Formula of Statistical Mechanics, with Applications to Astronomy and Thermodynamics." Proceedings of the American Association for the Advancement of Science, "33", 57–58 (1884). Reproduced in "The Scientific Papers of J. Willard Gibbs, Vol II" (1906), . It is referred to as the Liouville equation because its derivation for non-canonical systems utilises an identity first derived by Liouville in 1838. Consider a Hamiltonian system|Hamiltonian dynamical system with canonical coordinates <math>q_i</math> and conjugate momenta <math>p_i</math>, where <math>i=1,\dots,n</math>. Then the phase space distribution <math>\rho(p,q)</math> determines the probability <math>\rho(p,q)\; \mathrm{d}^nq\,\mathrm{d}^n p</math> that the system will be found in the infinitesimal phase space volume <math>\mathrm{d} ^nq\,\mathrm{d}^n p</math>. The "Liouville equation" governs the evolution of <math>\rho(p,q;t)</math> in time <math>t</math>: :<math>\frac{d\rho}{dt}= \frac{\partial\rho}{\partial t} +\sum_{i=1}^n\left(\frac{\partial\rho}{\partial q_i}\dot{q}_i +\frac{\partial\rho}{\partial p_i}\dot{p}_i\right)=0.</math> Time derivatives are denoted by dots, and are evaluated according to Hamilton's equations for the system. This equation demonstrates the conservation of density in phase space (which was Willard Gibbs|Gibbs's name for the theorem). Liouville's theorem states that :"The distribution function is constant along any trajectory in phase space." A v:Advanced Classical Mechanics/Liouville's theorem|proof of Liouville's theorem uses the Divergence theorem#Multiple dimensions|"n"-dimensional divergence theorem.  This proof is based on the fact that the evolution of <math>\rho</math> obeys an "2n"-dimensional version of the continuity equation: :<math>\frac{\partial\rho}{\partial t}+\sum_{i=1}^n\left(\frac{\partial(\rho\dot{q}_i)}{\partial q_i}+\frac{\partial(\rho\dot{p}_i)}{\partial p_i}\right)=0.</math> That is, the 3-tuple <math>(\rho, \rho\dot{q}_i,\rho\dot{p}_i)</math> is a conserved current. Notice that the difference between this and Liouville's equation are the terms :<math>\rho\sum_{i=1}^n\left( \frac{\partial\dot{q}_i}{\partial q_i} +\frac{\partial\dot{p}_i}{\partial p_i}\right) =\rho\sum_{i=1}^n\left( \frac{\partial^2 H}{\partial q_i\,\partial p_i} -\frac{\partial^2 H}{\partial p_i \partial q_i}\right)=0,</math> where <math>H</math> is the Hamiltonian, and Hamilton's equations as well as conservation of the Hamiltonian along the flow have been used. That is, viewing the motion through phase space as a 'fluid flow' of system points, the theorem that the convective derivative of the density, <math>d \rho/dt</math>, is zero follows from the equation of continuity by noting that the 'velocity field' <math>(\dot p , \dot q)</math> in phase space has zero divergence (which follows from Hamilton's relations).Harald J.W. Müller-Kirsten, Introduction to Quantum Mechanics: Schrödinger Equation and Path Integral, 2nd ed., World Scientific (Singapore, 2012). Another illustration is to consider the trajectory of a cloud of points through phase space. It is straightforward to show that as the cloud stretches in one coordinate &ndash; <math>p_i</math> say &ndash; it shrinks in the corresponding <math>q^i </math> direction so that the product <math>\Delta p_i \, \Delta q^i </math> remains constant. ==Other formulations==  The theorem above is often restated in terms of the Poisson bracket as :<math>\frac{\partial\rho}{\partial t}=-\{\,\rho,H\,\}</math> or, in terms of the linear "Liouville operator" or "Liouvillian", :<math>\mathrm{i}\widehat{\mathbf{L}}=\sum_{i=1}^n \left=\{\bullet,H\}</math> as :<math>\frac{\partial \rho }{\partial t}+{\mathrm{i}\widehat{\mathbf{L}}}\rho =0.</math>  In ergodic theory and dynamical systems, motivated by the physical considerations given so far, there is a corresponding result also referred to as Liouville's theorem. In Hamiltonian mechanics, the phase space is a differentiable manifold|smooth manifold that comes naturally equipped with a smooth Measure (mathematics)|measure (locally, this measure is the 6"n"-dimensional Lebesgue measure). The theorem says this smooth measure is invariant under the Hamiltonian flow. More generally, one can describe the necessary and sufficient condition under which a smooth measure is invariant under a flow. The Hamiltonian case then becomes a corollary.  We can also formulate Liouville's Theorem in terms of symplectic geometry. For a given system, we can consider the phase space <math>(q^\mu, p_\mu)</math> of a particular Hamiltonian <math>H</math> as a manifold <math>(M,\omega)</math> endowed with a symplectic 2-form :<math>\omega = dp_\mu\wedge dq^\mu.</math> The volume form of our manifold is the top exterior power of the symplectic 2-form, and is just another representation of the measure on the phase space described above. On our phase space symplectic manifold we can define a Hamiltonian vector field generated by a function <math>f(q,p)</math> as :<math>X_f = \frac{\partial f}{\partial p_\mu}\frac{\partial}{\partial q^\mu} - \frac{\partial f}{\partial q^\mu}\frac{\partial}{\partial p_\mu}.</math> <!-- From this we see that the interior product gives <math>i_{X_f}\omega = -df</math>. --> Specifically, when the generating function is the Hamiltonian itself, <math>f(q,p) = H</math>, we get :<math>X_H = \frac{\partial H}{\partial p_\mu}\frac{\partial}{\partial q^\mu} - \frac{\partial H}{\partial q^\mu}\frac{\partial}{\partial p_\mu} = \frac{d q^\mu}{d t}\frac{\partial}{\partial q^\mu} + \frac{d p^\mu}{dt}\frac{\partial}{\partial p_\mu} = \frac{d}{dt}</math> where we utilized Hamilton's equations of motion and the definition of the chain rule. In this formalism, Liouville's Theorem states that the Lie derivative of the volume form is zero along the flow generated by <math>X_H</math>. That is, for <math>(M,\omega)</math> a 2n-dimensional symplectic manifold, :<math>\mathcal{L}_{X_H}(\omega^n) = 0.</math> In fact, the symplectic structure <math>\omega</math> itself is preserved, not only its top exterior power. That is, Liouville's Theorem also gives  Proves Liouville's theorem using the language of modern differential geometry. :<math>\mathcal{L}_{X_H}(\omega) = 0.</math>  The analog of Liouville equation in quantum mechanics describes the time evolution of a Density matrix|mixed state.  Canonical quantization yields a quantum-mechanical version of this theorem, the von Neumann equation.  This procedure, often used to devise quantum analogues of classical systems, involves describing a classical system using Hamiltonian mechanics.  Classical variables are then re-interpreted as quantum operators, while Poisson brackets are replaced by commutators.  In this case, the resulting equation is"The theory of open quantum systems", by Breuer and Petruccione, ."Statistical mechanics", by Schwabl, . :<math>\frac{\partial \rho}{\partial t} = \frac{1}{i \hbar},</math> where ρ is the density matrix. When applied to the expectation value of an observable, the corresponding equation is given by Ehrenfest's theorem, and takes the form :<math>\frac{d}{dt}\langle A\rangle = -\frac{1}{i \hbar}\langle \rangle,</math> where <math>A</math> is an observable. Note the sign difference, which follows from the assumption that the operator is stationary and the state is time-dependent. In the phase-space formulation of quantum mechanics, substituting the Moyal brackets for Poisson brackets in the phase-space analog of the von Neumann equation results in Phase-space formulation#Time evolution|compressibility of the probability fluid, and thus violations of Liouville's theorem incompressibility. This, then, leads to concomitant difficulties in defining meaningful quantum trajectories. == Examples ==  File:SHOPhaseSpaceUpdate.gif|300px|thumb|The time evolution of phase space for the simple harmonic oscillator (SHO). Here we have taken <math>m = \omega = 1</math> and are considering the region <math>p, q \in </math>. Consider an <math>N</math>-particle system in three dimensions, and focus on only the evolution of <math>\mathrm{d}\mathcal{N}</math> particles. Within phase space, these <math>\mathrm{d}\mathcal{N}</math> particles occupy an infinitesimal volume given by : <math>\mathrm{d}\Gamma = \displaystyle\prod_{i=1}^N d^3p_i d^3q_i.</math> We want <math>\frac{\mathrm{d}\mathcal{N}}{\mathrm{d}\Gamma}</math> to remain the same throughout time, so that <math>\rho(\Gamma, t)</math> is constant along the trajectories of the system. If we allow our particles to evolve by an infinitesimal time step <math>\delta t</math>, we see that each particle phase space location changes as : <math>\begin{cases} q_i' = q_i + \dot{q_i}\delta t,\\ p_i' = p_i + \dot{p_i}\delta t, \end{cases}</math> where <math>\dot{q_i}</math> and <math>\dot{p_i}</math> denote <math>\frac{dq_i}{dt}</math> and <math>\frac{dp_i}{dt}</math> respectively, and we have only kept terms linear in <math>\delta t</math>. Extending this to our infinitesimal hypercube <math>\mathrm{d}\Gamma</math>, the side lengths change as : <math>\begin{cases} dq_i' = dq_i + \frac{\partial\dot{q_i}}{\partial q_i}dq_i\delta t,\\ dp_i' = dp_i + \frac{\partial\dot{p_i}}{\partial p_i}dp_i\delta t. \end{cases}</math> To find the new infinitesimal phase-space volume <math>\mathrm{d}\Gamma'</math>, we need the product of the above quantities. To first order in <math>\delta t</math>, we get the following: : <math>dq_i'dp_i' = dq_idp_i\left.</math> So far, we have yet to make any specifications about our system. Let us now specialize to the case of <math>N</math> <math>3</math>-dimensional isotropic harmonic oscillators. That is, each particle in our ensemble can be treated as a simple harmonic oscillator. The Hamiltonian for this system is given by : <math>H = \displaystyle\sum_{i = 1}^{3N}\left(\frac{1}{2m}p_i^2 + \frac{m\omega^2}{2}q_i^2\right).</math> By using Hamilton's equations with the above Hamiltonian we find that the term in parentheses above is identically zero, thus yielding : <math>dq_i'dp_i' = dq_idp_i.</math> From this we can find the infinitesimal volume of phase space: : <math>\mathrm{d}\Gamma' = \displaystyle\prod_{i=1}^N d^3q_i'd^3p_i' = \prod_{i=1}^N d^3q_id^3p_i = \mathrm{d}\Gamma.</math> Thus we have ultimately found that the infinitesimal phase-space volume is unchanged, yielding : <math>\rho(\Gamma', t + \delta t) =  \frac{\mathrm{d}\mathcal{N}}{\mathrm{d}\Gamma'} =  \f ...

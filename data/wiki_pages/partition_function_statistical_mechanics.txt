    In physics, a "partition function" describes the statistics|statistical properties of a system in thermodynamic equilibrium.  Partition functions are function (mathematics)|functions of the thermodynamic state function|state variables,  such as the temperature and volume. Most of the aggregate thermodynamics|thermodynamic variables of the system, such as the energy|total energy, Thermodynamic free energy|free energy, entropy, and pressure, can be expressed in terms of the partition function or its derivatives. The partition function is dimensionless. Each partition function is constructed to represent a particular statistical ensemble (which, in turn, corresponds to a particular Thermodynamic free energy|free energy). The most common statistical ensembles have named partition functions. The "canonical partition function" applies to a canonical ensemble, in which the system is allowed to exchange heat with the Environment (systems)|environment at fixed temperature, volume, and number of particles. The "grand canonical partition function" applies to a grand canonical ensemble, in which the system can exchange both heat and particles with the environment, at fixed temperature, volume, and chemical potential. Other types of partition functions can be defined for different circumstances; see partition function (mathematics) for generalizations. The partition function has many physical meanings, as discussed in #Meaning and significance|Meaning and significance. == Canonical partition function ==  Initially, let us assume that a thermodynamically large system is in thermal contact with the environment, with a temperature "T", and both the volume of the system and the number of constituent particles are fixed. A collection of this kind of system comprises an ensemble called a canonical ensemble. The appropriate mathematical expression for the canonical partition function depends on the degrees of freedom of the system, whether the context is classical mechanics or quantum mechanics, and whether the spectrum of states is Discrete mathematics|discrete or Probability distribution#Continuous probability distribution|continuous. = For a canonical ensemble that is classical and discrete, the canonical partition function is defined as <math display="block"> Z = \sum_i e^{-\beta E_i}, </math> where * <math> i </math> is the index for the Microstate (statistical mechanics)|microstates of the system; * <math> e </math> is e (mathematical constant)|Euler's number; * <math> \beta </math> is the thermodynamic beta, defined as <math> \tfrac{1}{k_\text{B} T} </math> where <math>k_\text{B}</math> is Boltzmann's constant; * <math> E_i </math> is the total energy of the system in the respective Microstate (statistical mechanics)|microstate. The Exponential function|exponential factor <math> e^{-\beta E_i} </math> is otherwise known as the Boltzmann factor.  \right) .</math> To obtain <math> \lambda_1 </math>, one substitutes the probability into the first constraint: <math display="block">\begin{align} 1 &= \sum_i \rho_i \\   &= \exp \left( \frac{-k_\text{B} + \lambda_1}{k_\text{B}} \right) Z , \end{align}</math> where "<math> Z </math> is a constant number defined as the canonical ensemble partition function": <math display="block">Z \equiv \sum_i \exp \left( \frac{\lambda_2}{k_\text{B}} E_i \right) .</math> Isolating for <math> \lambda_1 </math> yields <math> \lambda_1 = - k_\text{B} \ln(Z) + k_\text{B} </math>. Rewriting <math> \rho_i </math> in terms of <math> Z </math> gives <math display="block"> \rho_i = \frac{1}{Z} \exp \left( \frac{\lambda_2}{k_\text{B}} E_i \right) .</math> Rewriting <math> S </math> in terms of <math> Z </math> gives <math display="block">\begin{align} S &= - k_\text{B} \sum_i \rho_i \ln \rho_i \\   &= - k_\text{B} \sum_i \rho_i \left( \frac{\lambda_2}{k_\text{B}} E_i - \ln(Z) \right) \\   &= - \lambda_2 \sum_i \rho_i E_i + k_\text{B} \ln(Z) \sum_i \rho_i \\   &= - \lambda_2 U + k_\text{B} \ln(Z) . \end{align}</math> To obtain <math> \lambda_2 </math>, we differentiate <math> S </math> with respect to the average energy <math> U </math> and apply the first law of thermodynamics, <math> dU = T dS - P dV </math>: <math display="block">\frac{dS}{dU} = -\lambda_2 \equiv \frac{1}{T} .</math> Thus the canonical partition function <math> Z </math> becomes <math display="block">Z \equiv \sum_i e^{-\beta E_i} ,</math> where <math> \beta \equiv 1/(k_\text{B} T) </math> is defined as the thermodynamic beta. Finally, the probability distribution <math> \rho_i </math> and entropy <math> S </math> are respectively <math display="block">\begin{align} \rho_i & = \frac{1}{Z} e^{-\beta E_i} , \\ S & = \frac{U}{T} + k_\text{B} \ln Z . \end{align}</math> }} = In classical mechanics, the Position (vector)|position and Momentum vector|momentum variables of a particle can vary continuously, so the set of microstates is actually uncountable set|uncountable. In "classical" statistical mechanics, it is rather inaccurate to express the partition function as a Sum (mathematics)|sum of discrete terms. In this case we must describe the partition function using an integral rather than a sum. For a canonical ensemble that is classical and continuous, the canonical partition function is defined as <math display="block"> Z = \frac{1}{h^3} \int e^{-\beta H(q, p)} \, \mathrm{d}^3 q \, \mathrm{d}^3 p, </math> where * <math> h </math> is the Planck constant; * <math> \beta </math> is the thermodynamic beta, defined as <math> \tfrac{1}{k_\text{B} T} </math>; * <math> H(q, p) </math> is the Hamiltonian mechanics|Hamiltonian of the system; * <math> q </math> is the Canonical coordinates|canonical position; * <math> p </math> is the Canonical coordinates|canonical momentum. To make it into a dimensionless quantity, we must divide it by "h", which is some quantity with units of action (physics)|action (usually taken to be Planck's constant). = For a gas of <math> N </math> identical classical particles in three dimensions, the partition function is <math display="block"> Z=\frac{1}{N!h^{3N}} \int \, \exp \left(-\beta \sum_{i=1}^N H(\textbf q_i, \textbf p_i) \right) \; \mathrm{d}^3 q_1 \cdots \mathrm{d}^3 q_N \, \mathrm{d}^3 p_1 \cdots \mathrm{d}^3 p_N </math> where * <math> h </math> is the Planck constant; * <math> \beta </math> is the thermodynamic beta, defined as <math> \tfrac{1}{k_\text{B} T} </math>; * <math> i </math> is the index for the particles of the system; * <math> H </math> is the Hamiltonian mechanics|Hamiltonian of a respective particle; * <math> q_i </math> is the Canonical coordinates|canonical position of the respective particle; * <math> p_i </math> is the Canonical coordinates|canonical momentum of the respective particle; * <math> \mathrm{d}^3 </math> is shorthand notation to indicate that <math> q_i </math> and <math> p_i </math> are vectors in three-dimensional space. The reason for the factorial factor "N"! is discussed #Partition functions of subsystems|below. The extra constant factor introduced in the denominator was introduced because, unlike the discrete form, the continuous form shown above is not dimensionless. As stated in the previous section, to make it into a dimensionless quantity, we must divide it by "h"<sup>3"N"</sup> (where "h" is usually taken to be Planck's constant). = For a canonical ensemble that is quantum mechanical and discrete, the canonical partition function is defined as the trace (linear algebra)|trace of the Boltzmann factor: <math display="block"> Z = \operatorname{tr} ( e^{-\beta \hat{H}} ), </math> where: * <math> \operatorname{tr} ( \circ ) </math> is the trace (linear algebra)|trace of a matrix; * <math> \beta </math> is the thermodynamic beta, defined as <math> \tfrac{1}{k_\text{B} T} </math>; * <math> \hat{H} </math> is the Hamiltonian (quantum mechanics)|Hamiltonian operator. The dimension of <math> e^{-\beta \hat{H}} </math> is the number of energy eigenstates of the system. = For a canonical ensemble that is quantum mechanical and continuous, the canonical partition function is defined as <math display="block"> Z = \frac{1}{h} \int \langle q, p | e^{-\beta \hat{H}} | q, p \rangle \, \mathrm{d} q \, \mathrm{d} p, </math> where: * <math> h </math> is the Planck constant; * <math> \beta </math> is the thermodynamic beta, defined as <math> \tfrac{1}{k_\text{B} T} </math>; * <math> \hat{H} </math> is the Hamiltonian (quantum mechanics)|Hamiltonian operator; * <math> q </math> is the Canonical coordinates|canonical position; * <math> p </math> is the Canonical coordinates|canonical momentum. In systems with multiple quantum states "s" sharing the same energy "E<sub>s</sub>", it is said that the energy levels of the system are Degenerate energy levels|degenerate. In the case of degenerate energy levels, we can write the partition function in terms of the contribution from energy levels (indexed by "j") as follows: <math display="block"> Z = \sum_j g_j \cdot e^{-\beta E_j},</math> where "g<sub>j</sub>" is the degeneracy factor, or number of quantum states "s" that have the same energy level defined by "E<sub>j</sub>" = "E<sub>s</sub>". The above treatment applies to "quantum" statistical mechanics, where a physical system inside a Particle in a box|finite-sized box will typically have a discrete set of energy eigenstates, which we can use as the states "s" above. In quantum mechanics, the partition function can be more formally written as a trace over the mathematical formulation of quantum mechanics|state space (which is independent of the choice of basis (linear algebra)|basis): <math display="block">Z = \operatorname{tr} ( e^{-\beta \hat{H}} ),</math> where  is the Hamiltonian (quantum mechanics)|quantum Hamiltonian operator. The exponential of an operator can be defined using the Characterizations of the exponential function|exponential power series. The classical form of "Z" is recovered when the trace is expressed in terms of coherent states and when quantum-mechanical uncertainty principle|uncertainties in the position and momentum of a particle  are regarded as negligible. Formally, using bra–ket notation, one inserts under the trace for each degree of freedom the identity: <math display="block"> \boldsymbol{1} = \int |x, p\rangle \langle x,p| \frac{dx \,dp}{h},</math> where  is a Normalizing constant|normalised Wave packet#Gaussian wave packets in quantum mechanics|Gaussian wavepacket centered at position "x" and momentum "p". Thus <math display="block">  Z = \int \operatorname{tr} \left( e^{-\beta\hat{H}} |x, p\rangle \langle x, p| \right) \frac{dx \,dp}{h}    = \int \langle x,p| e^{-\beta\hat{H}} |x, p\rangle \frac{dx \,dp}{h}. </math> A coherent state is an approximate eigenstate of both operators <math> \hat{x} </math> and <math> \hat{p} </math>, hence also of the Hamiltonian {{math| ...
